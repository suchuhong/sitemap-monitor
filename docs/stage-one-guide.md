# 阶段 1 新增功能使用指南

本文总结 Stage 1 迭代带来的核心能力，并说明如何在日常使用中体验这些更新。

## 1. 登录与工作区隔离

- 打开 `/login`，输入企业邮箱即可登录；系统会为邮箱生成独立工作区并设置会话，30 天内保持登录状态。
- 顶部导航展示当前邮箱，可随时点击 “退出” 返回登录页。
- 登录后访问 `/dashboard`、`/sites`、`/sites/:id` 等页面将自动加载当前账号的数据；如未登录会重定向到 `/login`。

## 2. 站点与数据的多租户隔离

- 所有列表、统计与导出均只会呈现当前账号所拥有的站点，无需担心数据泄露。
- `/api` 下的接口同样做了权限校验：例如 `/api/sites/:id`、`/api/sites/:id/changes.csv`、`/api/sites/:id/webhooks` 等仅允许拥有者访问。
- 若访问他人站点 ID，会返回 `404 Not Found` 或 `401 Unauthorized`，确保隔离生效。

## 3. 批量导入结果面板

- `/sites/import` 支持粘贴或上传 CSV，导入完成后将显示每个站点的处理结果：
  - `成功`：站点已创建或更新，并显示站点 ID。
  - `跳过`：URL 不合法（缺少协议等），不会送入导入流程。
  - `失败`：发现异常时会展示错误信息，便于排查。
- 成功数量会在摘要中统计，表格展示完整明细，可直接重试失败的站点。

## 4. 手动扫描的任务队列

- 在站点详情页点击 “手动扫描” 时，后端会将任务加入队列并立即返回排队中的扫描 ID。
- 队列机制保证扫描不会阻塞页面请求，也避免并发冲突；完成后可在“最近扫描”列表查看状态和耗时。
- 若触发失败，前端会给出具体错误提示；成功排队则展示扫描 ID 前缀以便跟踪。

## 5. Dashboard 与列表的准确统计

- Dashboard 的站点总数、24 小时变更、失败率、排行榜等指标现在仅统计当前账号的数据。
- 站点管理页的标签筛选、统计卡片同样遵循多租户隔离逻辑。

---

如需进一步了解未来规划，请参阅 `docs/roadmap.md`。如果在使用中遇到问题，欢迎更新此文档或提 Issue 以帮助团队持续迭代。
